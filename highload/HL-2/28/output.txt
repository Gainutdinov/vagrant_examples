Задание:
Замечание: данная задача подразумевает, что уже имеется настроенный EFK-кластер (см. задачу «HL 33. EFK. Единичный экземпляр»).
1. Создайте тестовую ВМ со следующими параметрами:
○ 1 CPU,
○ 1Гб оперативной памяти,
○ 25Гб - диск.
2. Добавьте в файл /etc/security/limits.conf следующие параметры:
root soft nofile 65536
root hard nofile 65536
* soft nofile 65536
* hard nofile 65536
3. и перезагрузите тестовую ВМ.
4. Установите td-agent версии 3.x.
5. Создайте конфигурационый файл /etc/td-agent/td-agent.conf, который:
○ позволяет принимать сообщения syslog на порту 5140 UDP и помечает их тегом system;
○ пересылает полученные сообщения в Elasticsearch кластера EFK.
6. Включите td-agent и стартуйте его.
7. Убедитесь, что td-agent успешно стартовал и слушает порт 5140 UDP.
8. Добавьте в конфигурацию rsyslog отправку логов на адрес 127.0.0.1:5140.
Перезапустите rsyslog.
9. Откройте Kibana и убедитесь, что логи с тестовой ВМ видны на странице Discover.
